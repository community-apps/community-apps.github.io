<!DOCTYPE html>
<html>
<head>
	<title>Bot Maxim</title>
	<script src="https://vk.com/js/api/xd_connection.js?2"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script>
$(document).ready(function() {
	VK.init(function() {

	}, function() {
		VK.addCallback('onAppWidgetPreviewFail', function(data){
			console.log('onAppWidgetPreviewFail: ' + data);
		});
		VK.addCallback('onAppWidgetPreviewCancel', function(data){
			console.log('onAppWidgetPreviewCancel: ' + data);
		});
		VK.addCallback('onAppWidgetPreviewSuccess', function(data){
			console.log('onAppWidgetPreviewSuccess: ' + data);
		});
	}, '5.69');
});
		let data= {
		"title": "Цsитата",
		"title_url": "https://vk.com/app6310533",
		"title_counter": 42,
		"more": "Читать все цитаты",
		"more_url": "https://vk.com/app6310533",
		"text": "«Нам нужно гордиться»",
		"descr": name + " о победе сторонников выхода страны \r\n из Евросоюза на референдуме",
		};
function getWidget(data){
    let result = "var data = " + JSON.stringify(data) + ";";
        result += `
        var user = API.users.get({ fields: ["photo_id"] })[0];
        var result = {
            title: "Привет, " + user.first_name + "!!! :)",
            rows: [{
                icon_id: "id" + user.id,
                title: user.first_name + ", мы рады видеть Вас в нашем сообществе!",
                text: data.text,
                button: "Написать админу", 
                button_url: "https://vk.com/write77731755"
            }]
        };
        return result;
    `;
    return result;
}
		
VK.callMethod("showAppWidgetPreviewBox", 'list', getWidget(data));
</script>
</head>
<body>


</body>
</html>